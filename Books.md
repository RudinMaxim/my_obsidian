# Ð ÑƒÐºÐ¾Ð²Ð¾Ð´ÑÑ‚Ð²Ð¾ Ð¿Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÑŽ ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹ ÐºÐ½Ð¸Ð³

## ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ
Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° ÐºÐ½Ð¸Ð³ â€” ÑÑ‚Ð¾ DataviewJS-ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Obsidian, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ ÑÐ¿Ð¸ÑÐ¾Ðº ÐºÐ½Ð¸Ð³ Ð² Ð²Ð¸Ð´Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸ÐµÐ¹, ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ¾Ð¹ Ð¸ ÑÑ‚Ð¸Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ¾Ð¼.

## Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ°
1. Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð² Ñ„Ð°Ð¹Ð»Ðµ Ñ Ñ€Ð°ÑÑˆÐ¸Ñ€ÐµÐ½Ð¸ÐµÐ¼ `.js` Ð² Ð²Ð°ÑˆÐµÐ¹ Ð¿Ð°Ð¿ÐºÐµ Obsidian.
2. Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ð¿ÑƒÑ‚ÑŒ Ðº ÐºÐ½Ð¸Ð³Ð°Ð¼ Ð² ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ (`CONFIG.PATHS.BOOKS`) ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÐµÑ‚ Ð²Ð°ÑˆÐµÐ¹ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ðµ: `"3. Resourses/3. ÐšÐ½Ð¸Ð³Ð¸"`.
3. Ð’ Ð·Ð°Ð¼ÐµÑ‚ÐºÐµ Obsidian Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ ÐºÐ¾Ð´:
   ```dataviewjs
   dv.executeJs("Ð¿ÑƒÑ‚ÑŒ/Ðº/Ð²Ð°ÑˆÐµÐ¼Ñƒ/ÑÐºÑ€Ð¸Ð¿Ñ‚Ñƒ.js");
   ```

## Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ðµ
- **Ð¤Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ñ**:
  - Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð²Ñ‹Ð¿Ð°Ð´Ð°ÑŽÑ‰Ð¸Ð¹ ÑÐ¿Ð¸ÑÐ¾Ðº Ð´Ð»Ñ Ð²Ñ‹Ð±Ð¾Ñ€Ð° ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸ (Ñ‚ÐµÐ³Ð°).
  - Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð·Ð°Ð¿Ñ€Ð¾Ñ Ð² Ð¿Ð¾Ð»Ðµ Ð¿Ð¾Ð¸ÑÐºÐ° Ð´Ð»Ñ Ñ„Ð¸Ð»ÑŒÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ ÐºÐ½Ð¸Ð³Ð¸.
- **Ð¡Ð¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ°**:
  - ÐšÐ»Ð¸ÐºÐ½Ð¸Ñ‚Ðµ Ð½Ð° Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº ÑÑ‚Ð¾Ð»Ð±Ñ†Ð° (ÐšÐ½Ð¸Ð³Ð°, ÐÐ²Ñ‚Ð¾Ñ€, Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³, Ð¡Ñ‚Ð°Ñ‚ÑƒÑ, Ð”Ð°Ñ‚Ð°) Ð´Ð»Ñ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ¸.
  - ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð½Ñ‹Ð¹ ÐºÐ»Ð¸Ðº Ð¼ÐµÐ½ÑÐµÑ‚ Ð½Ð°Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ¸ (Ð¿Ð¾ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°Ð½Ð¸ÑŽ/ÑƒÐ±Ñ‹Ð²Ð°Ð½Ð¸ÑŽ).
- **ÐŸÑ€Ð¾ÑÐ¼Ð¾Ñ‚Ñ€**:
  - Ð¢Ð°Ð±Ð»Ð¸Ñ†Ð° Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ Ð¾Ð±Ð»Ð¾Ð¶ÐºÑƒ, Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ, Ð°Ð²Ñ‚Ð¾Ñ€Ð°, ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸, Ñ€ÐµÐ¹Ñ‚Ð¸Ð½Ð³, ÑÑ‚Ð°Ñ‚ÑƒÑ Ð¸ Ð´Ð°Ñ‚Ñƒ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ñ.
  - ÐšÐ»Ð¸Ðº Ð¿Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸ÑŽ ÐºÐ½Ð¸Ð³Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ð²Ð°ÐµÑ‚ ÑÐ²ÑÐ·Ð°Ð½Ð½ÑƒÑŽ Ð·Ð°Ð¼ÐµÑ‚ÐºÑƒ.

## ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð½Ð°Ñ…Ð¾Ð´ÑÑ‚ÑÑ Ð² Ð¾Ð±ÑŠÐµÐºÑ‚Ðµ `CONFIG` Ð² Ð½Ð°Ñ‡Ð°Ð»Ðµ ÑÐºÑ€Ð¸Ð¿Ñ‚Ð°:
- `PATHS.BOOKS`: Ð¿ÑƒÑ‚ÑŒ Ðº Ð¿Ð°Ð¿ÐºÐµ Ñ ÐºÐ½Ð¸Ð³Ð°Ð¼Ð¸.
- `TAGS.BASE`: Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ñ‚ÐµÐ³ (`book`).
- `UI.STYLES`: ÑÑ‚Ð¸Ð»Ð¸ Ð´Ð»Ñ ÑÐ»ÐµÐ¼ÐµÐ½Ñ‚Ð¾Ð² Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ°.
- `UI.TEXT`: Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ðµ Ð¿Ð¾Ð´Ð¿Ð¸ÑÐ¸ (Ð¿Ð»ÐµÐ¹ÑÑ…Ð¾Ð»Ð´ÐµÑ€Ñ‹, ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð¾Ð± Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ð¸ ÐºÐ½Ð¸Ð³).
- `TABLE.HEADERS`: Ð·Ð°Ð³Ð¾Ð»Ð¾Ð²ÐºÐ¸ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹.
- `TABLE.STATUS_COLORS`: Ñ†Ð²ÐµÑ‚Ð° Ð´Ð»Ñ ÑÑ‚Ð°Ñ‚ÑƒÑÐ¾Ð².
- `SORT`: Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ ÑÐ¾Ñ€Ñ‚Ð¸Ñ€Ð¾Ð²ÐºÐ¸ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ.

## ÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ñ
- Ð•ÑÐ»Ð¸ ÐºÐ½Ð¸Ð³Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹, Ð¾Ñ‚Ð¾Ð±Ñ€Ð°Ð¶Ð°ÐµÑ‚ÑÑ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Â«ÐšÐ½Ð¸Ð³Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹Â».
- Ð”Ð»Ñ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾Ð¹ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ÐºÐ°Ð¶Ð´Ð°Ñ ÐºÐ½Ð¸Ð³Ð° Ð´Ð¾Ð»Ð¶Ð½Ð° Ð¸Ð¼ÐµÑ‚ÑŒ Ñ‚ÐµÐ³ `book` Ð¸ Ð¾Ð±Ð»Ð¾Ð¶ÐºÑƒ (`cover`).

## ÐŸÑ€Ð¸Ð¼ÐµÑ€ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð·Ð°Ð¼ÐµÑ‚ÐºÐ¸ ÐºÐ½Ð¸Ð³Ð¸
```markdown
---
tags: [book, fantasy]
cover: Ð¿ÑƒÑ‚ÑŒ/Ðº/Ð¾Ð±Ð»Ð¾Ð¶ÐºÐµ.jpg
author: Ð˜Ð¼Ñ ÐÐ²Ñ‚Ð¾Ñ€Ð°
rating: 4
status: Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ
modified: 2025-05-30
---
```

```js
const CONFIG = {
    PATHS: {
        BOOKS: '"3. Resourses/3. ÐšÐ½Ð¸Ð³Ð¸"',
    },
    TAGS: {
        BASE: 'book',
    },
    UI: {
        STYLES: {
            wrapper: `
                display: flex;
                gap: 1rem;
                margin-bottom: 1.5rem;
                padding: 1rem;
                background: var(--background-secondary);
                border-radius: 8px;
                border: 1px solid var(--background-modifier-border);
            `,
            select: `
                padding: 0.5rem;
                border-radius: 6px;
                border: 1px solid var(--background-modifier-border);
                background: var(--background-primary);
                color: var(--text-normal);
                min-width: 150px;
            `,
            input: `
                flex: 1;
                padding: 0.5rem;
                border-radius: 6px;
                border: 1px solid var(--background-modifier-border);
                background: var(--background-primary);
                color: var(--text-normal);
            `,
            table: `
                width: 100%;
                border-collapse: collapse;
                background: var(--background-primary);
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            `,
            headerRow: `
                background: var(--background-secondary);
                border-bottom: 2px solid var(--background-modifier-border);
            `,
            headerCell: `
                padding: 1rem;
                text-align: left;
                font-weight: 600;
                color: var(--text-normal);
            `,
            row: `
                border-bottom: 1px solid var(--background-modifier-border);
                transition: background-color 0.2s ease;
            `,
            cell: `
                padding: 1rem;
                vertical-align: top;
            `,
            noResults: `
                padding: 2rem;
                text-align: center;
                color: var(--text-muted);
                font-style: italic;
            `,
        },
        TEXT: {
            selectPlaceholder: 'Ð’ÑÐµ ÐºÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ð¸',
            searchPlaceholder: 'ðŸ” ÐŸÐ¾Ð¸ÑÐº ÐºÐ½Ð¸Ð³Ð¸...',
            noResults: 'ÐšÐ½Ð¸Ð³Ð¸ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹',
        },
    },
    TABLE: {
        HEADERS: [
            { text: 'ðŸ“• ÐžÐ±Ð»Ð¾Ð¶ÐºÐ°', field: null },
            { text: 'ðŸ“˜ ÐšÐ½Ð¸Ð³Ð°', field: 'title' },
            { text: 'âœï¸ ÐÐ²Ñ‚Ð¾Ñ€', field: 'author' },
            { text: 'ðŸ“š ÐšÐ°Ñ‚ÐµÐ³Ð¾Ñ€Ð¸Ñ', field: null },
            { text: 'â­ Ð ÐµÐ¹Ñ‚Ð¸Ð½Ð³', field: 'rating' },
            { text: 'ðŸ“Š Ð¡Ñ‚Ð°Ñ‚ÑƒÑ', field: 'status' },
            { text: 'ðŸ“… Ð”Ð°Ñ‚Ð°', field: 'modified' },
        ],
        STATUS_COLORS: {
            'Ð’ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐµ': '#3b82f6',
            'Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ñ‹Ðµ': '#10b981',
            'Ð’ Ð¿Ð»Ð°Ð½Ð°Ñ…': '#f59e0b',
        },
    },
    SORT: {
        DEFAULT_FIELD: null,
        DEFAULT_DIRECTION: 'asc',
    },
};

class BookDataService {
    constructor() {
        this.pages = dv.pages(CONFIG.PATHS.BOOKS).where(p => p.cover);
    }

    getFilteredTags() {
        const tags = new Set();
        this.pages.forEach(page => {
            this.normalizeTags(page.tags).forEach(tag => {
                if (tag && tag !== CONFIG.TAGS.BASE) tags.add(tag);
            });
        });
        return Array.from(tags).sort();
    }

    normalizeTags(tags) {
        if (!tags) return [];
        return Array.isArray(tags) ? tags : [tags];
    }

    filterPages(filter) {
        return this.pages.filter(page => this.isPageMatchingFilters(page, filter));
    }

    isPageMatchingFilters(page, { tag, search }) {
        const tagMatch = !tag || this.normalizeTags(page.tags)
            .filter(t => t !== CONFIG.TAGS.BASE)
            .includes(tag);

        const searchMatch = !search ||
            page.file.name.toLowerCase().includes(search.toLowerCase());

        return tagMatch && searchMatch;
    }

    sortPages(pages, sortConfig) {
        if (!sortConfig.field) return pages;

        return [...pages].sort((a, b) => {
            let valueA, valueB;

            switch (sortConfig.field) {
                case 'title':
                    valueA = a.file.name.toLowerCase();
                    valueB = b.file.name.toLowerCase();
                    break;
                case 'author':
                    valueA = (a.author || '').toLowerCase();
                    valueB = (b.author || '').toLowerCase();
                    break;
                case 'rating':
                    valueA = a.rating || 0;
                    valueB = b.rating || 0;
                    break;
                case 'status':
                    valueA = (a.status || '').toLowerCase();
                    valueB = (b.status || '').toLowerCase();
                    break;
                case 'modified':
                    valueA = a.modified || a.created || new Date(0);
                    valueB = b.modified || b.created || new Date(0);
                    break;
                default:
                    return 0;
            }

            return valueA < valueB
                ? sortConfig.direction === 'asc' ? -1 : 1
                : valueA > valueB
                    ? sortConfig.direction === 'asc' ? 1 : -1
                    : 0;
        });
    }
}

class BookUIRenderer {
    constructor(container, onFilterChange, onSortChange) {
        this.container = container;
        this.onFilterChange = onFilterChange;
        this.onSortChange = onSortChange;
        this.dataService = new BookDataService();
    }

    createSelectElement() {
        const select = document.createElement('select');
        select.style.cssText = CONFIG.UI.STYLES.select;

        const defaultOption = document.createElement('option');
        defaultOption.textContent = CONFIG.UI.TEXT.selectPlaceholder;
        defaultOption.value = '';
        select.appendChild(defaultOption);

        this.dataService.getFilteredTags().forEach(tag => {
            const option = document.createElement('option');
            option.textContent = tag;
            option.value = tag;
            select.appendChild(option);
        });

        select.onchange = () => this.onFilterChange({ tag: select.value });

        return select;
    }

    createSearchInput() {
        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = CONFIG.UI.TEXT.searchPlaceholder;
        input.style.cssText = CONFIG.UI.STYLES.input;

        input.oninput = () => this.onFilterChange({ search: input.value });

        return input;
    }

    createTableHeader(sortConfig) {
        const headerRow = document.createElement('tr');
        headerRow.style.cssText = CONFIG.UI.STYLES.headerRow;

        CONFIG.TABLE.HEADERS.forEach(header => {
            const th = document.createElement('th');
            th.textContent = header.text;
            th.style.cssText = CONFIG.UI.STYLES.headerCell +
                (header.field ? 'cursor: pointer; user-select: none;' : '');

            if (header.field && sortConfig.field === header.field) {
                th.textContent += sortConfig.direction === 'asc' ? ' â†‘' : ' â†“';
            }

            if (header.field) {
                th.addEventListener('click', () => this.onSortChange(header.field));
            }

            headerRow.appendChild(th);
        });

        return headerRow;
    }

    createBookRow(page) {
        const row = document.createElement('tr');
        row.style.cssText = CONFIG.UI.STYLES.row;

        row.addEventListener('mouseenter', () => {
            row.style.backgroundColor = 'var(--background-secondary)';
        });
        row.addEventListener('mouseleave', () => {
            row.style.backgroundColor = 'transparent';
        });

        const coverCell = document.createElement('td');
        coverCell.style.cssText = CONFIG.UI.STYLES.cell;
        coverCell.innerHTML = page.cover
            ? `<img src="${page.cover}" width="80" style="border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">`
            : '<div style="width: 80px; height: 120px; background: var(--background-secondary); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--text-muted);">â€”</div>';
        row.appendChild(coverCell);

        const titleCell = document.createElement('td');
        titleCell.style.cssText = CONFIG.UI.STYLES.cell;
        const link = document.createElement('a');
        link.href = page.file.path;
        link.textContent = page.file.name;
        link.className = 'internal-link';
        link.style.cssText = `
            font-weight: 500;
            font-size: 1.1em;
            color: var(--text-accent);
            text-decoration: none;
        `;
        titleCell.appendChild(link);
        row.appendChild(titleCell);

        const authorCell = document.createElement('td');
        authorCell.style.cssText = CONFIG.UI.STYLES.cell + 'color: var(--text-muted);';
        authorCell.textContent = page.author || 'â€“';
        row.appendChild(authorCell);

        const tagsCell = document.createElement('td');
        tagsCell.style.cssText = CONFIG.UI.STYLES.cell;
        const filteredTags = this.dataService.normalizeTags(page.tags)
            .filter(tag => tag !== CONFIG.TAGS.BASE);

        if (filteredTags.length > 0) {
            const tagsContainer = document.createElement('div');
            tagsContainer.style.cssText = 'display: flex; flex-wrap: wrap; gap: 0.5rem;';

            filteredTags.forEach(tag => {
                const tagSpan = document.createElement('span');
                tagSpan.textContent = tag;
                tagSpan.style.cssText = `
                    background: var(--text-accent);
                    color: var(--background-primary);
                    padding: 0.25rem 0.5rem;
                    border-radius: 12px;
                    font-size: 0.85em;
                    font-weight: 500;
                `;
                tagsContainer.appendChild(tagSpan);
            });

            tagsCell.appendChild(tagsContainer);
        } else {
            tagsCell.textContent = 'â€“';
            tagsCell.style.color = 'var(--text-muted)';
        }
        row.appendChild(tagsCell);

        const ratingCell = document.createElement('td');
        ratingCell.style.cssText = CONFIG.UI.STYLES.cell;
        const rating = page.rating || 0;
        const starsContainer = document.createElement('div');
        starsContainer.style.cssText = 'font-size: 1.2em;';

        for (let i = 1; i <= 5; i++) {
            const star = document.createElement('span');
            star.textContent = i <= rating ? 'â˜…' : 'â˜†';
            star.style.color = i <= rating ? '#ffd700' : 'var(--text-muted)';
            starsContainer.appendChild(star);
        }
        ratingCell.appendChild(starsContainer);
        row.appendChild(ratingCell);

        const statusCell = document.createElement('td');
        statusCell.style.cssText = CONFIG.UI.STYLES.cell;
        const status = page.status || '';
        if (status) {
            const statusSpan = document.createElement('span');
            statusSpan.textContent = status;
            statusSpan.style.cssText = `
                background: ${CONFIG.TABLE.STATUS_COLORS[status] || 'var(--text-muted)'};
                color: white;
                padding: 0.25rem 0.75rem;
                border-radius: 16px;
                font-size: 0.85em;
                font-weight: 500;
            `;
            statusCell.appendChild(statusSpan);
        } else {
            statusCell.textContent = 'â€“';
            statusCell.style.color = 'var(--text-muted)';
        }
        row.appendChild(statusCell);

        const dateCell = document.createElement('td');
        dateCell.style.cssText = CONFIG.UI.STYLES.cell + 'color: var(--text-muted); font-size: 0.9em;';
        const date = page.modified || page.created;
        dateCell.textContent = date ? date.toFormat('dd.MM.yyyy') : 'â€“';
        row.appendChild(dateCell);

        return row;
    }

    renderNoResults() {
        const div = document.createElement('div');
        div.textContent = CONFIG.UI.TEXT.noResults;
        div.style.cssText = CONFIG.UI.STYLES.noResults;
        return div;
    }

    renderUI() {
        const wrapper = document.createElement('div');
        wrapper.style.cssText = CONFIG.UI.STYLES.wrapper;

        wrapper.appendChild(this.createSelectElement());
        wrapper.appendChild(this.createSearchInput());
        this.container.appendChild(wrapper);
    }

    renderTable(filter, sortConfig) {
        const existingTable = this.container.querySelector('table');
        if (existingTable) existingTable.remove();

        const table = document.createElement('table');
        table.className = 'dataview table-view-table';
        table.style.cssText = CONFIG.UI.STYLES.table;

        table.appendChild(this.createTableHeader(sortConfig));

        const filteredPages = this.dataService.filterPages(filter);
        const sortedPages = this.dataService.sortPages(filteredPages, sortConfig);

        if (sortedPages.length === 0) {
            const noResultsRow = document.createElement('tr');
            const noResultsCell = document.createElement('td');
            noResultsCell.colSpan = CONFIG.TABLE.HEADERS.length;
            noResultsCell.appendChild(this.renderNoResults());
            noResultsRow.appendChild(noResultsCell);
            table.appendChild(noResultsRow);
        } else {
            sortedPages.forEach(page => {
                table.appendChild(this.createBookRow(page));
            });
        }

        this.container.appendChild(table);
    }
}

class BookSystem {
    constructor(container) {
        if (!container) throw new Error('Container is required');
        this.container = container;
        this.filter = { tag: '', search: '' };
        this.sortConfig = { field: CONFIG.SORT.DEFAULT_FIELD, direction: CONFIG.SORT.DEFAULT_DIRECTION };
        this.renderer = new BookUIRenderer(
            container,
            (filterUpdate) => this.updateFilter(filterUpdate),
            (field) => this.handleSort(field)
        );
        this.init();
    }

    init() {
        this.renderer.renderUI();
        this.renderer.renderTable(this.filter, this.sortConfig);
    }

    updateFilter(filterUpdate) {
        this.filter = { ...this.filter, ...filterUpdate };
        this.renderer.renderTable(this.filter, this.sortConfig);
    }

    handleSort(field) {
        if (this.sortConfig.field === field) {
            this.sortConfig.direction = this.sortConfig.direction === 'asc' ? 'desc' : 'asc';
        } else {
            this.sortConfig.field = field;
            this.sortConfig.direction = CONFIG.SORT.DEFAULT_DIRECTION;
        }
        this.renderer.renderTable(this.filter, this.sortConfig);
    }
}

new BookSystem(this.container);
```